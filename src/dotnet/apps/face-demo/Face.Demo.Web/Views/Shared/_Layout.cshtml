@{
    Layout = null;
    var appTitleFa = "سکوی تشخیص چهره";
    var appTitleEn = "Face Recognition Platform";
}

<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="utf-8" />
    <title>@appTitleFa - @ViewData["Title"]</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Bootstrap 5 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
          rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
          crossorigin="anonymous">

    <style>
        body {
            font-family: system-ui, -apple-system, Segoe UI, sans-serif;
            background: #0b1020;
            color: #f3f4f6;
        }

        .app-layout {
            display: grid;
            grid-template-rows: 64px 1fr 40px;
            grid-template-columns: 260px 1fr;
            grid-template-areas:
                "header header"
                "sidebar main"
                "footer footer";
            height: 100vh;
        }

        header.app-header {
            grid-area: header;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding-inline: 1.5rem;
            background: radial-gradient(circle at 0 0, #1f2937, #020617);
            border-bottom: 1px solid #1f2937;
        }

        .logo-container {
            display: flex;
            align-items: center;
            gap: .75rem;
        }

        .logo-svg {
            width: 40px;
            height: 40px;
        }

        .logo-text-fa {
            font-weight: 700;
            font-size: 1.05rem;
        }

        .logo-text-en {
            font-size: .75rem;
            color: #9ca3af;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: .75rem;
            font-size: .8rem;
            color: #9ca3af;
        }

        aside.app-sidebar {
            grid-area: sidebar;
            background: #020617;
            border-left: 1px solid #1f2937;
            padding: 1rem;
            overflow-y: auto;
        }

        main.app-main {
            grid-area: main;
            padding: 1rem 1.5rem;
            overflow-y: auto;
        }

        footer.app-footer {
            grid-area: footer;
            font-size: .75rem;
            color: #6b7280;
            border-top: 1px solid #1f2937;
            padding-inline: 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #020617;
        }

        .menu-section-title {
            font-size: .8rem;
            color: #9ca3af;
            margin-top: .75rem;
            margin-bottom: .1rem;
        }

        .menu-section-subtitle {
            font-size: .7rem;
            color: #6b7280;
            margin-bottom: .25rem;
        }

        .menu-list {
            list-style: none;
            padding: 0;
            margin: 0 0 .5rem 0;
        }

        .menu-item a {
            display: block;
            padding: .4rem .7rem;
            border-radius: .5rem;
            text-decoration: none;
            color: #e5e7eb;
            font-size: .85rem;
        }

        .menu-item a:hover,
        .menu-item a.active {
            background: linear-gradient(90deg, #3b82f6, #06b6d4);
            color: white;
        }

        .page-title-fa {
            font-size: 1.2rem;
            font-weight: 600;
        }

        .page-title-en {
            font-size: .8rem;
            color: #9ca3af;
        }

        .lang-toggle-btn {
            font-size: .75rem;
            border-radius: 999px;
            border: 1px solid #4b5563;
            background: #020617;
            color: #e5e7eb;
            padding: .15rem .7rem;
            cursor: pointer;
        }

        .lang-toggle-btn span {
            font-weight: 600;
        }

        .footer-email a {
            color: #9ca3af;
            text-decoration: none;
        }

        .footer-email a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <div class="app-layout">
        <!-- Header -->
        <header class="app-header">
            <div class="logo-container">
                <!-- لوگوی ساده SVG مرتبط با تشخیص چهره -->
                <svg class="logo-svg" viewBox="0 0 64 64">
                    <defs>
                        <linearGradient id="faceGradient" x1="0" x2="1" y1="0" y2="1">
                            <stop offset="0%" stop-color="#3b82f6" />
                            <stop offset="100%" stop-color="#22d3ee" />
                        </linearGradient>
                    </defs>
                    <!-- قاب دوربین -->
                    <rect x="6" y="6" width="52" height="52" rx="12"
                          stroke="url(#faceGradient)" stroke-width="2" fill="none" />
                    <!-- صورت ساده -->
                    <circle cx="32" cy="26" r="9"
                            stroke="url(#faceGradient)" stroke-width="2" fill="none" />
                    <path d="M20 44 C 26 38, 38 38, 44 44"
                          stroke="url(#faceGradient)" stroke-width="2" fill="none" />
                    <!-- نقطه فوکوس -->
                    <circle cx="47" cy="17" r="3" fill="#22d3ee" />
                </svg>

                <div class="d-flex flex-column">
                    <span class="logo-text-fa">@appTitleFa</span>
                    <span class="logo-text-en">@appTitleEn</span>
                </div>
            </div>

            <div class="header-right">
                <div id="currentLangDisplay">FA / فارسی</div>
                <button type="button" id="langToggleBtn" class="lang-toggle-btn">
                    <span>FA</span> | EN
                </button>
                <div>محیط: Development</div>
            </div>
        </header>

        <!-- Sidebar -->
        <aside class="app-sidebar">
            <!-- دسترسی‌های پشتیبانی -->
            <div class="menu-section mb-3">
                <div class="menu-section-title">
                    دسترسی‌های پشتیبانی
                </div>
                <div class="menu-section-subtitle">
                    Support Access
                </div>
                <ul class="menu-list">
                    <li class="menu-item">
                        <a asp-controller="Support" asp-action="RabbitQueues"
                           class="@(ViewContext.RouteData.Values["controller"]?.ToString() == "Support" ? "active" : "")">
                            وضعیت صف‌ها و درخواست‌ها
                            <span style="font-size:.7rem; color:#cbd5f5;">/ Queues &amp; Requests</span>
                        </a>
                    </li>
                </ul>
            </div>

            <!-- دسترسی‌های مدیر سیستم -->
            <div class="menu-section mb-3">
                <div class="menu-section-title">
                    دسترسی‌های مدیر سیستم
                </div>
                <div class="menu-section-subtitle">
                    System Admin Access
                </div>
                <ul class="menu-list">
                    <li class="menu-item">
                        <a asp-controller="Admin" asp-action="Users">
                            مدیریت کاربران
                            <span style="font-size:.7rem; color:#cbd5f5;">/ User Management</span>
                        </a>
                    </li>
                    <li class="menu-item">
                        <a asp-controller="Admin" asp-action="Roles">
                            مدیریت نقش کاربران
                            <span style="font-size:.7rem; color:#cbd5f5;">/ Role Management</span>
                        </a>
                    </li>
                </ul>
            </div>

            <!-- دسترسی‌های مدیران کسب‌وکار -->
            <div class="menu-section mb-3">
                <div class="menu-section-title">
                    دسترسی‌های مدیران کسب‌وکار
                </div>
                <div class="menu-section-subtitle">
                    Business Managers Access
                </div>
                <ul class="menu-list">
                    <li class="menu-item">
                        <a asp-controller="Business" asp-action="ManagerDashboard">
                            داشبورد مدیران
                            <span style="font-size:.7rem; color:#cbd5f5;">/ Manager Dashboard</span>
                        </a>
                    </li>
                </ul>
            </div>

            <!-- دسترسی‌های کاربران کسب‌وکار -->
            <div class="menu-section mb-3">
                <div class="menu-section-title">
                    دسترسی‌های کاربران کسب‌وکار
                </div>
                <div class="menu-section-subtitle">
                    Business Users Access
                </div>
                <ul class="menu-list">
                    <li class="menu-item">
                        <a asp-controller="Business" asp-action="UserDashboard">
                            داشبورد کاربران
                            <span style="font-size:.7rem; color:#cbd5f5;">/ User Dashboard</span>
                        </a>
                    </li>
                </ul>
            </div>
        </aside>

        <!-- Main -->
        <main class="app-main">
            @RenderBody()
        </main>

        <!-- Footer -->
        <footer class="app-footer">
            <div>
                © @DateTime.Now.Year - سکوی تشخیص چهره
            </div>
            <div class="footer-email">
                تماس:
                <a href="mailto:ali.reza.nazari@gmail.com" rel="nofollow noopener noreferrer">
                    ali.reza.nazari [at] gmail.com
                </a>
            </div>
        </footer>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
            crossorigin="anonymous"></script>

    <script>
        // مدیریت زبان با localStorage
        (function () {
            const KEY = "face_platform_lang";
            const html = document.documentElement;
            const langBtn = document.getElementById("langToggleBtn");
            const langDisplay = document.getElementById("currentLangDisplay");

            function applyLang(lang) {
                if (lang !== "fa" && lang !== "en") lang = "fa";
                html.lang = (lang === "fa") ? "fa" : "en";
                html.dir = (lang === "fa") ? "rtl" : "ltr";

                if (langDisplay) {
                    langDisplay.textContent = (lang === "fa") ? "FA / فارسی" : "EN / English";
                }
                if (langBtn) {
                    langBtn.innerHTML = (lang === "fa")
                        ? "<span>FA</span> | EN"
                        : "FA | <span>EN</span>";
                }
            }

            function loadLang() {
                const stored = localStorage.getItem(KEY);
                return stored || "fa";
            }

            function saveLang(lang) {
                localStorage.setItem(KEY, lang);
            }

            const initial = loadLang();
            applyLang(initial);

            if (langBtn) {
                langBtn.addEventListener("click", function () {
                    const current = loadLang();
                    const next = current === "fa" ? "en" : "fa";
                    saveLang(next);
                    applyLang(next);
                    // در آینده می‌توان اینجا call به API زد تا در DB و توکن نیز ذخیره شود.
                });
            }
        })();
    </script>

    @RenderSection("Scripts", required: false)
</body>
</html>
